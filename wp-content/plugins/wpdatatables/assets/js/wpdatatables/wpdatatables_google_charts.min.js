google.load("visualization","1",{packages:["corechart","bar","gauge","scatter"]});var wpDataTablesGoogleChart=function(){var a={rows:[],columns:[],type:"column",containerId:"googleChartContainer",columnIndexes:[],connectedWPDataTable:null,chart:null,googleDataTable:null,renderCallback:null,options:{animation:{duration:1e3,easing:"out",startup:!0},backgroundColor:{fill:"#FFFFFF",strokeWidth:0,stroke:"#666",rx:0},chartArea:{backgroundColor:{}},crosshair:{},curveType:"none",fontName:"Arial",fontSize:null,hAxis:{direction:1},height:400,legend:{position:"right"},orientation:"horizontal",titlePosition:"out",tooltip:{trigger:"focus"},vAxis:{direction:1,viewWindow:{}}},setRows:function(a){this.rows=a},enableDateTimeAxis:function(){this.options.hAxis.gridlines={count:-1,units:{days:{format:["MMM dd"]},hours:{format:["HH:mm","ha"]}}}},detectDates:function(){for(var a in this.columns)if("date"==this.columns[a].type||"datetime"==this.columns[a].type)for(var b in this.rows){var c=Date.parse(this.rows[b][a]);isNaN(c)?this.rows[b][a]=new Date:(this.rows[b][a]=new Date(c),null==this.connectedWPDataTable?this.rows[b][a].setTime(this.rows[b][a].getTime()+60*this.rows[b][a].getTimezoneOffset()*1e3):this.rows[b][a].setTime(this.rows[b][a].getTime())),"datetime"==this.columns[a].type&&this.enableDateTimeAxis()}},setColumns:function(a){this.columns=a},getColumns:function(){return this.columns},setOptions:function(b){for(var c in b)"responsive_width"!=c||"1"!=b[c]?this.options[c]=b[c]:(a.options.animation=!1,jQuery(window).resize(function(){a.chart.draw(a.googleDataTable,a.options)}))},getOptions:function(){return this.options},setType:function(a){this.type=a},getType:function(){return this.type},setGrouping:function(a){this.group_chart=a},setContainer:function(a){this.containerId=a},getContainer:function(){return this.containerId},setRenderCallback:function(a){this.renderCallback=a},render:function(){this.googleDataTable=new google.visualization.DataTable;for(var a in this.columns)this.googleDataTable.addColumn(this.columns[a]);switch(this.detectDates(),this.googleDataTable.addRows(this.rows),this.type){case"google_column_chart":this.chart=new google.visualization.ColumnChart(document.getElementById(this.containerId));break;case"google_histogram":this.chart=new google.visualization.Histogram(document.getElementById(this.containerId));break;case"google_bar_chart":this.options.orientation="vertical",this.chart=new google.visualization.BarChart(document.getElementById(this.containerId));break;case"google_area_chart":this.chart=new google.visualization.AreaChart(document.getElementById(this.containerId));break;case"google_stepped_area_chart":this.options.isStacked=!0,this.chart=new google.visualization.SteppedAreaChart(document.getElementById(this.containerId));break;case"google_line_chart":this.chart=new google.visualization.LineChart(document.getElementById(this.containerId));break;case"google_pie_chart":this.chart=new google.visualization.PieChart(document.getElementById(this.containerId));break;case"google_bubble_chart":this.chart=new google.visualization.BubbleChart(document.getElementById(this.containerId));break;case"google_donut_chart":this.options.pieHole=.4,this.chart=new google.visualization.PieChart(document.getElementById(this.containerId));break;case"google_gauge_chart":this.options.redFrom=90,this.options.redTo=100,this.options.yellowFrom=75,this.options.yellowTo=90,this.options.minorTicks=5,this.chart=new google.visualization.Gauge(document.getElementById(this.containerId));break;case"google_scatter_chart":this.chart=new google.visualization.ScatterChart(document.getElementById(this.containerId));break;case"google_candlestick_chart":this.chart=new google.visualization.CandlestickChart(document.getElementById(this.containerId))}null!==this.renderCallback&&this.renderCallback(this),this.chart.draw(this.googleDataTable,this.options)},refresh:function(){this.googleDataTable=new google.visualization.DataTable;for(var a in this.columns)this.googleDataTable.addColumn(this.columns[a]);this.detectDates(),this.googleDataTable.addRows(this.rows),null!==this.renderCallback&&this.renderCallback(this),this.chart.draw(this.googleDataTable,this.options)},setConnectedWPDataTable:function(a){this.connectedWPDataTable=a},getConnectedWPDataTable:function(){return this.connectedWPDataTable},enableFollowFiltering:function(){null!=this.connectedWPDataTable&&this.connectedWPDataTable.fnSettings().aoDrawCallback.push({sName:"chart_filter_follow",fn:function(b){var c=[];a.options.animation=!1;var d=a.connectedWPDataTable._("tr",{filter:"applied"}).toArray(),e=jQuery.parseJSON(jQuery("#"+a.connectedWPDataTable.data("described-by")).val()).datepickFormat,f=e.replace(/dd/,"DD").replace(/Y/g,"YYYY").replace(/y/g,"YY").replace(/M/g,"mmm").replace(/mm/g,"MM");f+=" "+jQuery.parseJSON(jQuery("#"+a.connectedWPDataTable.data("described-by")).val()).timeFormat.replace("i","mm");var g=jQuery.parseJSON(jQuery("#"+a.connectedWPDataTable.data("described-by")).val()).number_format;for(var h in d){var i=[];for(var j in a.columnIndexes)if("number"==a.columns[j].type){var k=d[h][a.columnIndexes[j]];if(isNaN(k)){if(1==g)var l=".",m=",";else var l=",",m=".";k=wdtUnformatNumber(k,l,m,!0)}i.push(parseFloat(k))}else"date"==a.columns[j].type?i.push(jQuery.datepicker.parseDate(e,d[h][a.columnIndexes[j]])):"datetime"==a.columns[j].type?(i.push(moment(d[h][a.columnIndexes[j]],f).toDate()),a.enableDateTimeAxis()):i.push(d[h][a.columnIndexes[j]]);c.push(i)}if(1==a.group_chart){var n=[];for(var h in c)if("undefined"!=typeof n&&n.length>0){var o="none";for(var j in n)"none"===o&&n[j][0]==c[h][0]&&(o=j);if("none"===o)n.push(c[h]);else for(var p in c[h])0!=p&&(n[o][p]+=c[h][p])}else n.push(c[h]);c=n}a.rows=c,a.refresh()}})},setColumnIndexes:function(a){this.columnIndexes=a},getColumnIndexes:function(){return this.columnIndexes}};return a};